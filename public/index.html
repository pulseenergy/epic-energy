<!DOCTYPE html>
<html>
<head>
<title>Legends of Energy 3: Downtown</title>
<link rel="stylesheet" href="global.css">

<script src="lib/underscore-1.4.0.js"></script>
<script src="lib/knockout-2.1.0.js"></script>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script src="lib/js/bootstrap-button.js"></script>
<script src="src/js/util.js"></script>

<script src="src/js/Occupant.js"></script>
<script src="src/js/Equipment.js"></script>
<script src="src/js/Game.js"></script>
<script src="src/js/ViewModel.js"></script>
<script>
	var game, viewModel;

	$(function () {
		$('#fullscreen-button').click(goFullScreen);
		game = new Game();
		viewModel = new ViewModel(game);
		ko.applyBindings(viewModel);
	});
</script>
</head>
<body>

<div class="month-tracker">
	<div class="container">
		<div class="row">
			<span class="span12">
				<ul>
					<li data-bind="css: { selected: month() === 0 }">Jan</li>
					<li data-bind="css: { selected: month() === 1 }">Feb</li>
					<li data-bind="css: { selected: month() === 2 }">Mar</li>
					<li data-bind="css: { selected: month() === 3 }">Apr</li>
					<li data-bind="css: { selected: month() === 4 }">May</li>
					<li data-bind="css: { selected: month() === 5 }">Jun</li>
					<li data-bind="css: { selected: month() === 6 }">Jul</li>
					<li data-bind="css: { selected: month() === 7 }">Aug</li>
					<li data-bind="css: { selected: month() === 8 }">Sep</li>
					<li data-bind="css: { selected: month() === 9 }">Oct</li>
					<li data-bind="css: { selected: month() === 10 }">Nov</li>
					<li data-bind="css: { selected: month() === 11 }">Dec</li>
				</ul>
			</span>
		</div>
	</div>
</div>
<button class="btn btn-mini pull-left" id="fullscreen-button">Fullscreen</button>
<div class="main-body season-spring">
	<div class="container">

		<div class="row">
			<span class="left-column span4">
				<div class="building-container"></div>
				<div class="equipment-summary clearfix">
					<ul data-bind="foreach: equipment">
						<li data-bind="text: category, attr: { title: name }, css: { selected: $root.selectedCategory() === category }, click: $root.selectCategory.bind($root)"></li>
					</ul>
				</div>
			</span>
			<span class="right-column span8">
				<div id="above">
					<button class="btn btn-large btn-primary pull-right" data-bind="click: advanceToNextMonth, disable: gameOver">Next</button>
					<div data-bind="foreach: messages"><span data-bind="text: $data"></span></div>
					<div data-bind="text: '$' + budget() + ' remaining'"></div>
					<div id="occupants" data-bind="foreach: occupants">
						<span class="occupant" data-bind="text: happiness, attr: { 'title': happinessLabel }, class: happinessLabel"></span>
					</div>
					<div data-bind="text: 'Date: ' + monthName()"></div>
					<div data-bind="text: 'Average Temperature: ' + weather().mean + '\u00b0C'"></div>
					<div data-bind="text: energy() + ' kWh consumed'"></div>
					<div id="pendingAction">
						<!-- ko if: !pendingAction() -->
							<h4>No Pending Action</h4>
						<!-- /ko -->
						<!-- ko if: pendingAction -->
							<h4>Pending Action</h4>
							<ul data-bind="with: pendingAction">
								<li>
									<span data-bind="text: category"></span>
									<span data-bind="text: message"></span>
								</li>
							</ul>
						<!-- /ko -->
					</div>

				</div>
				<div id="availableActions">
					<h4>Available Actions</h4>
					<!-- ko if: !selectedCategory() -->
						<p>Select a category to see available actions.</p>
					<!-- /ko -->
					<!-- ko if: selectedCategory() -->
						<!-- ko if: !availableActionsForSelectedCategory().length -->
							<p>No available actions.</p>
						<!-- /ko -->
						<div data-bind="foreach: availableActionsForSelectedCategory" class="container">
							<div class="row">
								<div class="span6" data-bind="text: name"></div>
								<div class="span1" data-bind="text: formattedCost"></div>
								<div class="span1">
									<button class="btn" data-bind="click: $root.pendingAction">Do It</button>
								</div>
							</div>
						</div>
					<!-- /ko -->
				</div>
			</span>
		</div>
	</div>

	<div class="game-over" data-bind="visible: gameOver">
		<h2>Game Over!</h2>
		<p>Your score was <span data-bind="text: finalScore"></span>, which is pretty weak.</p>
	</div>
</div>

</body>
</html>
